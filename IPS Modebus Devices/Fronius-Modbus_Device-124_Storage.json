{
    "Addresses": [
        {
            "Active": true,
            "ByteOrder": -1,
            "DataType": 2,
            "Factor": 0,
            "Ident": "SunSpecModel",
            "Length": 0,
            "Name": "[40354] Sunspec Model 'Storage'",
            "Profile": "",
            "ReadAddress": 40353,
            "ReadFunctionCode": 3,
            "Translation": [],
            "WriteAddress": 0,
            "WriteFunctionCode": 0
        },
        {
            "Active": true,
            "ByteOrder": -1,
            "DataType": 2,
            "Factor": 0,
            "Ident": "40356_WChaMax",
            "Length": 0,
            "Name": "[40356] WChaMax - Maximum Charge and Discharge Power",
            "Profile": "Fronius.Watt",
            "ReadAddress": 40355,
            "ReadFunctionCode": 3,
            "Translation": [],
            "WriteAddress": 0,
            "WriteFunctionCode": 0
        },
        {
            "Active": true,
            "ByteOrder": -1,
            "DataType": 2,
            "Factor": 0,
            "Ident": "40357_WChaGra",
            "Length": 0,
            "Name": "[40357] WChaGra - Maximum Charging Rate",
            "Profile": "Fronius.Percent",
            "ReadAddress": 40356,
            "ReadFunctionCode": 3,
            "Translation": [],
            "WriteAddress": 0,
            "WriteFunctionCode": 0
        },
        {
            "Active": true,
            "ByteOrder": -1,
            "DataType": 2,
            "Factor": 0,
            "Ident": "40358_WDisChaGra",
            "Length": 0,
            "Name": "[40358] WDisChaGra - Maximum Discharge Rate",
            "Profile": "Fronius.Percent",
            "ReadAddress": 40357,
            "ReadFunctionCode": 3,
            "Translation": [],
            "WriteAddress": 0,
            "WriteFunctionCode": 0
        },
        {
            "Active": true,
            "ByteOrder": -1,
            "DataType": 5,
            "Factor": 0,
            "Ident": "40359_StorCtl_Mod",
            "Length": 0,
            "Name": "[40359] StorCtl_Mod RW (bitfield16)",
            "Profile": "Fronius.StorCtl_Mod",
            "ReadAddress": 40358,
            "ReadFunctionCode": 3,
            "Translation": [],
            "WriteAddress": 40358,
            "WriteFunctionCode": 6
        },
        {
            "Active": true,
            "ByteOrder": -1,
            "DataType": 2,
            "Factor": 0,
            "Ident": "40360_VAChaMax",
            "Length": 0,
            "Name": "[40360] VAChaMax RW - Maximum Charging VA",
            "Profile": "Fronius.VAChaMax",
            "ReadAddress": 40359,
            "ReadFunctionCode": 3,
            "Translation": [],
            "WriteAddress": 40359,
            "WriteFunctionCode": 6
        },
        {
            "Active": true,
            "ByteOrder": -1,
            "DataType": 2,
            "Factor": 0.01,
            "Ident": "40361_MinRsvPct",
            "Length": 0,
            "Name": "[40361] MinRsvPct RW - Minimum Reserve for Storage",
            "Profile": "Fronius.Percent.1",
            "ReadAddress": 40360,
            "ReadFunctionCode": 3,
            "Translation": [],
            "WriteAddress": 40360,
            "WriteFunctionCode": 6
        },
        {
            "Active": true,
            "ByteOrder": -1,
            "DataType": 2,
            "Factor": 0.01,
            "Ident": "40362_ChaState",
            "Length": 0,
            "Name": "[40362] ChaState - SOC",
            "Profile": "Fronius.Percent.1",
            "ReadAddress": 40361,
            "ReadFunctionCode": 3,
            "Translation": [],
            "WriteAddress": 0,
            "WriteFunctionCode": 0
        },
        {
            "Active": true,
            "ByteOrder": -1,
            "DataType": 5,
            "Factor": 0,
            "Ident": "40365_ChaSt",
            "Length": 0,
            "Name": "[40365] ChaSt (enum16)",
            "Profile": "Fronius.ChaSt",
            "ReadAddress": 40364,
            "ReadFunctionCode": 3,
            "Translation": [],
            "WriteAddress": 0,
            "WriteFunctionCode": 0
        },
        {
            "Active": true,
            "ByteOrder": -1,
            "DataType": 5,
            "Factor": 0.01,
            "Ident": "40366_OutWRte",
            "Length": 0,
            "Name": "[40366] OutWRte RW - Max Discharge Rate",
            "Profile": "Fronius.InWRte_OutWRte",
            "ReadAddress": 40365,
            "ReadFunctionCode": 3,
            "Translation": [],
            "WriteAddress": 40365,
            "WriteFunctionCode": 6
        },
        {
            "Active": true,
            "ByteOrder": -1,
            "DataType": 5,
            "Factor": 0.01,
            "Ident": "40367_InWRte",
            "Length": 0,
            "Name": "[40367] InWRte RW - Max Charging Rate",
            "Profile": "Fronius.InWRte_OutWRte",
            "ReadAddress": 40366,
            "ReadFunctionCode": 3,
            "Translation": [],
            "WriteAddress": 40366,
            "WriteFunctionCode": 6
        },
        {
            "Active": true,
            "ByteOrder": -1,
            "DataType": 2,
            "Factor": 0,
            "Ident": "40369_InOutWRte_RvrtTms",
            "Length": 0,
            "Name": "[40369] InOutWRte_RvrtTms RW - Timeout Period for Charge/Discharge Rate",
            "Profile": "Fronius.RvrtTms",
            "ReadAddress": 40368,
            "ReadFunctionCode": 3,
            "Translation": [],
            "WriteAddress": 40368,
            "WriteFunctionCode": 6
        },
        {
            "Active": true,
            "ByteOrder": -1,
            "DataType": 5,
            "Factor": 0,
            "Ident": "40371_ChaGriSet",
            "Length": 0,
            "Name": "[40371] ChaGriSet RW (enum16)",
            "Profile": "Fronius.ChaGriSet",
            "ReadAddress": 40370,
            "ReadFunctionCode": 3,
            "Translation": [],
            "WriteAddress": 40370,
            "WriteFunctionCode": 6
        },
        {
            "Active": true,
            "ByteOrder": -1,
            "DataType": 5,
            "Factor": 0,
            "Ident": "40372_WChaMax_SF",
            "Length": 0,
            "Name": "[40372] WChaMax_SF",
            "Profile": "Fronius.ScaleFactor",
            "ReadAddress": 40371,
            "ReadFunctionCode": 3,
            "Translation": [],
            "WriteAddress": 0,
            "WriteFunctionCode": 0
        },
        {
            "Active": true,
            "ByteOrder": -1,
            "DataType": 5,
            "Factor": 0,
            "Ident": "40373_WChaDisChaGra_SF",
            "Length": 0,
            "Name": "[40373] WChaDisChaGra_SF",
            "Profile": "Fronius.ScaleFactor",
            "ReadAddress": 40372,
            "ReadFunctionCode": 3,
            "Translation": [],
            "WriteAddress": 0,
            "WriteFunctionCode": 0
        },
        {
            "Active": true,
            "ByteOrder": -1,
            "DataType": 5,
            "Factor": 0,
            "Ident": "40375_MinRsvPct_SF",
            "Length": 0,
            "Name": "[40375] MinRsvPct_SF",
            "Profile": "Fronius.ScaleFactor",
            "ReadAddress": 40374,
            "ReadFunctionCode": 3,
            "Translation": [],
            "WriteAddress": 0,
            "WriteFunctionCode": 0
        },
        {
            "Active": true,
            "ByteOrder": -1,
            "DataType": 5,
            "Factor": 0,
            "Ident": "40376_ChaState_SF",
            "Length": 0,
            "Name": "[40376] ChaState_SF",
            "Profile": "Fronius.ScaleFactor",
            "ReadAddress": 40375,
            "ReadFunctionCode": 3,
            "Translation": [],
            "WriteAddress": 0,
            "WriteFunctionCode": 0
        },
        {
            "Active": true,
            "ByteOrder": -1,
            "DataType": 5,
            "Factor": 0,
            "Ident": "40379_InOutWRte_SF",
            "Length": 0,
            "Name": "[40379] InOutWRte_SF",
            "Profile": "Fronius.ScaleFactor",
            "ReadAddress": 40378,
            "ReadFunctionCode": 3,
            "Translation": [],
            "WriteAddress": 0,
            "WriteFunctionCode": 0
        }
    ],
    "ByteOrder": 0,
    "Profiles": {
        "Fronius.CHARGE_MAX": {
            "Associations": [
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "DEAKTIVIERT",
                    "Value": -50.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "DEAKTIVIERT",
                    "Value": -1.0
                },
                {
                    "Color": 16711680,
                    "Icon": "",
                    "Name": "0 W - Ladung gesperrt (nur Entladen)",
                    "Value": 0.0
                },
                {
                    "Color": 13875981,
                    "Icon": "",
                    "Name": "%.1f W Lade-Limit aktiv",
                    "Value": 1.0
                }
            ],
            "Digits": 1,
            "Icon": "",
            "MaxValue": 20500.0,
            "MinValue": -50.0,
            "Prefix": "",
            "StepSize": 50.0,
            "Suffix": "",
            "Type": 2
        },
        "Fronius.CHARGE_MIN": {
            "Associations": [
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "DEAKTIVIERT",
                    "Value": -50.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "DEAKTIVIERT",
                    "Value": -1.0
                },
                {
                    "Color": 16711680,
                    "Icon": "",
                    "Name": "0 W - Entladung gesperrt (nur Laden)",
                    "Value": 0.0
                },
                {
                    "Color": 10034643,
                    "Icon": "",
                    "Name": "%.1f W - Erzwungene Ladung",
                    "Value": 1.0
                }
            ],
            "Digits": 1,
            "Icon": "",
            "MaxValue": 20500.0,
            "MinValue": -50.0,
            "Prefix": "",
            "StepSize": 50.0,
            "Suffix": "",
            "Type": 2
        },
        "Fronius.ChaGriSet": {
            "Associations": [
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "[%d] PV - Charging from Grid Disabled",
                    "Value": 0.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "[%d] GRID - Charging from Grid ENABLED",
                    "Value": 1.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "[%d] n.a.",
                    "Value": 2.0
                }
            ],
            "Digits": 0,
            "Icon": "",
            "MaxValue": 1.0,
            "MinValue": 0.0,
            "Prefix": "",
            "StepSize": 1.0,
            "Suffix": "",
            "Type": 1
        },
        "Fronius.ChaSt": {
            "Associations": [
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "[%d] n.a.",
                    "Value": 0.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "[%d] OFF",
                    "Value": 1.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "[%d] EMPTY",
                    "Value": 2.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "[%d] DISCHAGING",
                    "Value": 3.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "[%d] CHARGING",
                    "Value": 4.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "[%d] FULL",
                    "Value": 5.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "[%d] HOLDING",
                    "Value": 6.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "[%d] TESTING",
                    "Value": 7.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "[%d] n.a.",
                    "Value": 8.0
                }
            ],
            "Digits": 0,
            "Icon": "",
            "MaxValue": 7.0,
            "MinValue": 0.0,
            "Prefix": "",
            "StepSize": 1.0,
            "Suffix": "",
            "Type": 1
        },
        "Fronius.DISCHARGE_MAX": {
            "Associations": [
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "DEAKTIVIERT",
                    "Value": -50.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "DEAKTIVIERT",
                    "Value": -1.0
                },
                {
                    "Color": 16711680,
                    "Icon": "",
                    "Name": "0 W - Entladung gesperrt (nur Laden)",
                    "Value": 0.0
                },
                {
                    "Color": 14458888,
                    "Icon": "",
                    "Name": "%.1f W - Entlade Limit aktiv",
                    "Value": 1.0
                }
            ],
            "Digits": 1,
            "Icon": "",
            "MaxValue": 20500.0,
            "MinValue": -50.0,
            "Prefix": "",
            "StepSize": 50.0,
            "Suffix": "",
            "Type": 2
        },
        "Fronius.DISCHARGE_MIN": {
            "Associations": [
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "DEAKTIVIERT",
                    "Value": -50.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "DEAKTIVIERT",
                    "Value": -1.0
                },
                {
                    "Color": 16711680,
                    "Icon": "",
                    "Name": "0 W - Ladung gesperrt (nur Entladen)",
                    "Value": 0.0
                },
                {
                    "Color": 381620,
                    "Icon": "",
                    "Name": "%.1f W - fixe Entladung",
                    "Value": 1.0
                }
            ],
            "Digits": 1,
            "Icon": "",
            "MaxValue": 20500.0,
            "MinValue": -50.0,
            "Prefix": "",
            "StepSize": 50.0,
            "Suffix": "",
            "Type": 2
        },
        "Fronius.InWRte_OutWRte": {
            "Associations": [
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "%.1f %%",
                    "Value": -100.0
                },
                {
                    "Color": 255,
                    "Icon": "",
                    "Name": "%.1f %%",
                    "Value": -99.5
                },
                {
                    "Color": 255,
                    "Icon": "",
                    "Name": "%.1f %%",
                    "Value": -0.1
                },
                {
                    "Color": 16711680,
                    "Icon": "",
                    "Name": "%.1f %%",
                    "Value": 0.0
                },
                {
                    "Color": 13107300,
                    "Icon": "",
                    "Name": "%.1f %%",
                    "Value": 0.1
                },
                {
                    "Color": 13107300,
                    "Icon": "",
                    "Name": "%.1f %%",
                    "Value": 99.5
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "%.1f %%",
                    "Value": 100.0
                }
            ],
            "Digits": 1,
            "Icon": "",
            "MaxValue": 100.0,
            "MinValue": -100.0,
            "Prefix": "",
            "StepSize": 0.5,
            "Suffix": "",
            "Type": 2
        },
        "Fronius.InWRte_Watt": {
            "Associations": [
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "max Entladung : %.1f W",
                    "Value": -24480.0
                },
                {
                    "Color": 381620,
                    "Icon": "",
                    "Name": "fixe Entladung: %.1f W",
                    "Value": -24479.0
                },
                {
                    "Color": 381620,
                    "Icon": "",
                    "Name": "fixe Entladung: %.1f W",
                    "Value": -1.0
                },
                {
                    "Color": 16711680,
                    "Icon": "",
                    "Name": " %.1f W",
                    "Value": 0.0
                },
                {
                    "Color": 13875469,
                    "Icon": "",
                    "Name": "Laden mit Sonne begrenzt: %.1f W",
                    "Value": 1.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "Ladebegrenzung DEAKTIVIERT",
                    "Value": 20480.0
                }
            ],
            "Digits": 1,
            "Icon": "",
            "MaxValue": 0.0,
            "MinValue": 0.0,
            "Prefix": "",
            "StepSize": 100.0,
            "Suffix": "",
            "Type": 2
        },
        "Fronius.OutWRte_Watt": {
            "Associations": [
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "erzwungene Nachladung: %.1f W",
                    "Value": -20480.0
                },
                {
                    "Color": 10034643,
                    "Icon": "",
                    "Name": "erzwungene Nachladung: %.1f W",
                    "Value": -1.0
                },
                {
                    "Color": 16711680,
                    "Icon": "",
                    "Name": " %.1f W",
                    "Value": 0.0
                },
                {
                    "Color": 14458960,
                    "Icon": "",
                    "Name": "Entladeleistung begrenzt: %.1f W",
                    "Value": 1.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "Entladebegrenzung DEAKTIVIERT",
                    "Value": 20480.0
                }
            ],
            "Digits": 1,
            "Icon": "",
            "MaxValue": 0.0,
            "MinValue": 0.0,
            "Prefix": "",
            "StepSize": 100.0,
            "Suffix": "",
            "Type": 2
        },
        "Fronius.Percent": {
            "Associations": [],
            "Digits": 0,
            "Icon": "",
            "MaxValue": 100.0,
            "MinValue": 0.0,
            "Prefix": "",
            "StepSize": 1.0,
            "Suffix": " %",
            "Type": 1
        },
        "Fronius.Percent.1": {
            "Associations": [],
            "Digits": 2,
            "Icon": "",
            "MaxValue": 100.0,
            "MinValue": 0.0,
            "Prefix": "",
            "StepSize": 1.0,
            "Suffix": " %",
            "Type": 2
        },
        "Fronius.RvrtTms": {
            "Associations": [],
            "Digits": 0,
            "Icon": "",
            "MaxValue": 28800.0,
            "MinValue": 0.0,
            "Prefix": "",
            "StepSize": 1.0,
            "Suffix": " sec",
            "Type": 1
        },
        "Fronius.ScaleFactor": {
            "Associations": [
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "NaN",
                    "Value": -32768.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "n.a. [%d]",
                    "Value": -32767.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "OutOfRange [%d]",
                    "Value": -11.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "10^ %d",
                    "Value": -10.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "10^ %d",
                    "Value": 10.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "OutOfRange [%d]",
                    "Value": 11.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "n.a. [%d]",
                    "Value": 32767.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "NaN",
                    "Value": 32768.0
                }
            ],
            "Digits": 0,
            "Icon": "",
            "MaxValue": 10.0,
            "MinValue": -10.0,
            "Prefix": "",
            "StepSize": 1.0,
            "Suffix": "",
            "Type": 1
        },
        "Fronius.StorCtl_Mod": {
            "Associations": [
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "[%d] Standardbetrieb",
                    "Value": 0.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "[%d] CHARGE - Lade Limit",
                    "Value": 1.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "[%d] DiSCHARGE - Entlade Limit",
                    "Value": 2.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "[%d] CHARGE & DiSCHARGE",
                    "Value": 3.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "[%d] n.a.",
                    "Value": 4.0
                }
            ],
            "Digits": 0,
            "Icon": "",
            "MaxValue": 3.0,
            "MinValue": 0.0,
            "Prefix": "",
            "StepSize": 1.0,
            "Suffix": "",
            "Type": 1
        },
        "Fronius.VAChaMax": {
            "Associations": [
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "%d VA",
                    "Value": 0.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "%d VA",
                    "Value": 65534.0
                },
                {
                    "Color": -1,
                    "Icon": "",
                    "Name": "NaN",
                    "Value": 65535.0
                }
            ],
            "Digits": 0,
            "Icon": "",
            "MaxValue": 0.0,
            "MinValue": 0.0,
            "Prefix": "",
            "StepSize": 250.0,
            "Suffix": "",
            "Type": 1
        },
        "Fronius.Watt": {
            "Associations": [],
            "Digits": 0,
            "Icon": "",
            "MaxValue": 0.0,
            "MinValue": 0.0,
            "Prefix": "",
            "StepSize": 200.0,
            "Suffix": " W",
            "Type": 1
        }
    },
    "Requests": {
        "Interval": 5000
    },
    "VirtualAddresses": [
        {
            "Active": true,
            "Ident": "VA_UpdateCnt",
            "Name": "Update Cnt",
            "Profile": "",
            "ReadAction": "$varId = @IPS_GetObjectIDByIdent(\"VA_UpdateCnt\", $_IPS['TARGET']);\r\nif ($varId === false) { return -1; } else { return GetValueInteger($varId)+1; }",
            "Translation": [],
            "VariableType": 1,
            "WriteAction": ""
        },
        {
            "Active": true,
            "Ident": "VA_LastUpdate",
            "Name": "Last Update",
            "Profile": "~UnixTimestamp",
            "ReadAction": "if(false) {\r\n    $ipsTarget = $_IPS['TARGET'];\r\n    $logSender = sprintf(\"[%s] %s\", $ipsTarget, IPS_GetName($ipsTarget));\r\n    $logMsg = sprintf(\"Fronius Modbus SunSpecModel '%s' updated\", $VALUES[\"SunSpecModel\"]);\r\n    IPS_LogMessage($logSender, $logMsg);\r\n}\r\nreturn (time());",
            "Translation": [],
            "VariableType": 1,
            "WriteAction": ""
        },
        {
            "Active": true,
            "Ident": "VA_OutWRte_Watt",
            "Name": "OutWRte_Watt",
            "Profile": "Fronius.OutWRte_Watt",
            "ReadAction": "$WChaMax = $VALUES[\"40356_WChaMax\"];\r\n$StorCtl_Mod = $VALUES[\"40359_StorCtl_Mod\"];\r\nif(($StorCtl_Mod == 2) OR ($StorCtl_Mod == 3)) {\r\n    $OutWRte = $VALUES[\"40366_OutWRte\"];\r\n    $OutWRte_Watt = round($WChaMax / 100 * $OutWRte, 2);\r\n    return $OutWRte_Watt;\r\n} else {\r\n    return $WChaMax;\r\n}",
            "Translation": [],
            "VariableType": 2,
            "WriteAction": "$WChaMax = $VALUES[\"40356_WChaMax\"];\r\n$StorCtl_Mod = $VALUES[\"40359_StorCtl_Mod\"];\r\nif($StorCtl_Mod != 3) { $StorCtl_Mod = 2; }\r\n$OutWRte = round(100/$WChaMax * $VALUE, 2);\r\nif($OutWRte > 100) { $OutWRte = 100; } else if ($OutWRte < -100) { $OutWRte = -100; }\r\nreturn [\"40366_OutWRte\" => $OutWRte, \"40359_StorCtl_Mod\" =>  $StorCtl_Mod];"
        },
        {
            "Active": true,
            "Ident": "VA_InWRte_Watt",
            "Name": "InWRte_Watt",
            "Profile": "Fronius.InWRte_Watt",
            "ReadAction": "$WChaMax = $VALUES[\"40356_WChaMax\"];\r\n$StorCtl_Mod = $VALUES[\"40359_StorCtl_Mod\"];\r\nif(($StorCtl_Mod == 1) OR ($StorCtl_Mod == 3)) {\r\n    $InWRte = $VALUES[\"40367_InWRte\"];\r\n    $InWRte_Watt = round($WChaMax / 100 * $InWRte, 2);\r\n    return $InWRte_Watt;\r\n} else {\r\n    return $WChaMax;\r\n}",
            "Translation": [],
            "VariableType": 2,
            "WriteAction": "$WChaMax = $VALUES[\"40356_WChaMax\"];\r\n$StorCtl_Mod = $VALUES[\"40359_StorCtl_Mod\"];\r\nif($StorCtl_Mod != 3) { $StorCtl_Mod = 1; }\r\n$InWRte = round(100/$WChaMax * $VALUE, 2);\r\nif($InWRte > 100) { $InWRte = 100; } else if ($InWRte < -100) { $InWRte = -100; }\r\nreturn [\"40367_InWRte\" => $InWRte, \"40359_StorCtl_Mod\" =>  $StorCtl_Mod];"
        },
        {
            "Active": true,
            "Ident": "VA_CHARGE_MAX",
            "Name": "CHARGE_MAX",
            "Profile": "Fronius.CHARGE_MAX",
            "ReadAction": "$WChaMax = $VALUES[\"40356_WChaMax\"];\r\n$StorCtl_Mod = $VALUES[\"40359_StorCtl_Mod\"];\r\n$InWRte = $VALUES[\"40367_InWRte\"];\r\nif(($StorCtl_Mod == 1) OR ($StorCtl_Mod == 3)) {\r\n    if($InWRte == 100) { \r\n        return -1; \r\n    } elseif ($InWRte == 0) {\r\n        return $InWRte;\r\n    } elseif ($InWRte < 0) {\r\n       return -1;\r\n    } else {\r\n       return round($WChaMax / 100 * $InWRte, 1);\r\n    }\r\n} else {\r\n    return -1;\r\n}",
            "Translation": [],
            "VariableType": 2,
            "WriteAction": "$WChaMax = $VALUES[\"40356_WChaMax\"];\r\n$StorCtl_Mod = $VALUES[\"40359_StorCtl_Mod\"];\r\nif($VALUE < 0) {\r\n  $InWRte = 100; \r\n  if($StorCtl_Mod != 3) { $StorCtl_Mod = 1; }\r\n} else {\r\n  $InWRte = round(100/$WChaMax * $VALUE, 2);\r\n  if($InWRte > 100) { $InWRte = 100; } \r\n  if($StorCtl_Mod != 3) { \r\n    $StorCtl_Mod = 1;\r\n  } else {\r\n    $OutWRte = $VALUES[\"40366_OutWRte\"];\r\n    if( (-1 * $InWRte) > $OutWRte) {\r\n      $logMsg = sprintf(\"CHARGE_MAX - Invalid power window > Set StorCtl_Mod = 2 [40359_StorCtl_Mod: %s | 40366_OutWRte: %s | 40367_InWRte: %s | VALUE: %s] {%s | %s}\", $StorCtl_Mod, $OutWRte, $InWRte, $VALUE, $_IPS['SENDER'], IPS_GetName($_IPS['TARGET']));\r\n      $varIdLogInfo = @IPS_GetVariableIDByName(\"LogInfo\", $_IPS['TARGET']); if($varIdLogInfo !== false) { SetValue($varIdLogInfo, $logMsg); }\r\n      IPS_LogMessage(\"FroniusModBus_\".$_IPS['TARGET'].\"-WARN\", $logMsg);      \r\n      return [\"40359_StorCtl_Mod\" => 2];\r\n    }\r\n  } \r\n}\r\n$logMsg = sprintf(\"CHARGE_MAX | 40359_StorCtl_Mod: %s | 40367_InWRte: %s | VALUE: %s {%s | %s}\",  $StorCtl_Mod, $InWRte, $VALUE, $_IPS['SENDER'], IPS_GetName($_IPS['TARGET']));\r\n$varIdLogInfo = @IPS_GetVariableIDByName(\"LogInfo\", $_IPS['TARGET']); if($varIdLogInfo !== false) { SetValue($varIdLogInfo, $logMsg); }\r\nIPS_LogMessage(\"FroniusModBus_\".$_IPS['TARGET'], $logMsg);\r\nreturn [\"40367_InWRte\" => $InWRte, \"40359_StorCtl_Mod\" => $StorCtl_Mod];"
        },
        {
            "Active": true,
            "Ident": "VA_CHARGE_MIN",
            "Name": "CHARGE_MIN",
            "Profile": "Fronius.CHARGE_MIN",
            "ReadAction": "$WChaMax = $VALUES[\"40356_WChaMax\"];\r\n$StorCtl_Mod = $VALUES[\"40359_StorCtl_Mod\"];\r\n$OutWRte = $VALUES[\"40366_OutWRte\"];\r\nif($StorCtl_Mod >= 2) {\r\n    if($OutWRte >= 0) {\r\n       return -1; \r\n    } else {\r\n       return abs(round($WChaMax / 100 * $OutWRte, 1));\r\n    }\r\n} else {\r\n    return -1;\r\n}",
            "Translation": [],
            "VariableType": 2,
            "WriteAction": "$WChaMax = $VALUES[\"40356_WChaMax\"];\r\n$StorCtl_Mod = $VALUES[\"40359_StorCtl_Mod\"];\r\nif($VALUE < 0) {\r\n  $OutWRte = 100; \r\n  if($StorCtl_Mod != 3) { $StorCtl_Mod = 1; }\r\n} else {\r\n  $OutWRte = round(100/$WChaMax * $VALUE, 2) * -1;\r\n  if($OutWRte < -100) { $OutWRte = -100; }\r\n  if($StorCtl_Mod != 3) { \r\n    $StorCtl_Mod = 2;\r\n  } else {\r\n    $InWRte = $VALUES[\"40367_InWRte\"];\r\n    if( (-1 * $InWRte) > $OutWRte) {\r\n      $logMsg = sprintf(\"CHARGE_MIN - Invalid power window > Set StorCtl_Mod = 2 [40359_StorCtl_Mod: %s | 40366_OutWRte: %s | 40367_InWRte: %s | VALUE: %s] {%s | %s}\", $StorCtl_Mod, $OutWRte, $InWRte, $VALUE, $_IPS['SENDER'], IPS_GetName($_IPS['TARGET']));\r\n      $varIdLogInfo = @IPS_GetVariableIDByName(\"LogInfo\", $_IPS['TARGET']); if($varIdLogInfo !== false) { SetValue($varIdLogInfo, $logMsg); }\r\n      IPS_LogMessage(\"FroniusModBus_\".$_IPS['TARGET'].\"-WARN\", $logMsg);      \r\n      return [\"40359_StorCtl_Mod\" => 2];\r\n    }     \r\n  }\r\n}\r\n$logMsg = sprintf(\"CHARGE_MIN | 40359_StorCtl_Mod: %s | 40366_OutWRte: %s | VALUE: %s {%s | %s}\",  $StorCtl_Mod, $OutWRte, $VALUE, $_IPS['SENDER'], IPS_GetName($_IPS['TARGET']));\r\n$varIdLogInfo = @IPS_GetVariableIDByName(\"LogInfo\", $_IPS['TARGET']); if($varIdLogInfo !== false) { SetValue($varIdLogInfo, $logMsg); }\r\nIPS_LogMessage(\"FroniusModBus_\".$_IPS['TARGET'], $logMsg);\r\nreturn [\"40366_OutWRte\" => $OutWRte, \"40359_StorCtl_Mod\" => $StorCtl_Mod];"
        },
        {
            "Active": true,
            "Ident": "VA_DISCHARGE_MAX",
            "Name": "DISCHARGE_MAX",
            "Profile": "Fronius.DISCHARGE_MAX",
            "ReadAction": "$WChaMax = $VALUES[\"40356_WChaMax\"];\r\n$StorCtl_Mod = $VALUES[\"40359_StorCtl_Mod\"];\r\n$OutWRte = $VALUES[\"40366_OutWRte\"];\r\nif($StorCtl_Mod >= 2) {\r\n    if($OutWRte == 100) { \r\n        return -1; \r\n    } elseif ($OutWRte == 0) {\r\n      return $OutWRte;\r\n    } elseif ($OutWRte < 0) {\r\n       return -1;\r\n    } else {\r\n       return round($WChaMax / 100 * $OutWRte, 1);\r\n    }\r\n} else {\r\n    return -1;\r\n}",
            "Translation": [],
            "VariableType": 2,
            "WriteAction": "$WChaMax = $VALUES[\"40356_WChaMax\"];\r\n$StorCtl_Mod = $VALUES[\"40359_StorCtl_Mod\"];\r\n$OutWRte = $VALUES[\"40366_OutWRte\"];\r\nif($VALUE < 0) {\r\n  $OutWRte = 100; \r\n  if($StorCtl_Mod != 3) { $StorCtl_Mod = 1; }\r\n} else { \r\n  $OutWRte = round(100/$WChaMax * $VALUE, 2);\r\n  if($OutWRte > 100) { $OutWRte =  100; }\r\n  if($StorCtl_Mod != 3) {\r\n    $StorCtl_Mod = 2;  \r\n  } else {\r\n    $InWRte = $VALUES[\"40367_InWRte\"];\r\n    if( (-1 * $InWRte) > $OutWRte) {\r\n      $logMsg = sprintf(\"DISCHARGE_MAX - Invalid power window > Set StorCtl_Mod = 2 [40359_StorCtl_Mod: %s | 40366_OutWRte: %s | 40367_InWRte: %s | VALUE: %s] {%s | %s}\", $StorCtl_Mod, $OutWRte, $InWRte, $VALUE, $_IPS['SENDER'], IPS_GetName($_IPS['TARGET']));\r\n      $varIdLogInfo = @IPS_GetVariableIDByName(\"LogInfo\", $_IPS['TARGET']); if($varIdLogInfo !== false) { SetValue($varIdLogInfo, $logMsg); }\r\n      IPS_LogMessage(\"FroniusModBus_\".$_IPS['TARGET'].\"-WARN\", $logMsg);      \r\n      return [\"40359_StorCtl_Mod\" => 2];\r\n    }\r\n  }\r\n}\r\n$logMsg = sprintf(\"DISCHARGE_MAX | 40359_StorCtl_Mod: %s | 40366_OutWRte: %s | VALUE: %s {%s | %s}\",  $StorCtl_Mod, $OutWRte, $VALUE, $_IPS['SENDER'], IPS_GetName($_IPS['TARGET']));\r\n$varIdLogInfo = @IPS_GetVariableIDByName(\"LogInfo\", $_IPS['TARGET']); if($varIdLogInfo !== false) { SetValue($varIdLogInfo, $logMsg); }\r\nIPS_LogMessage(\"FroniusModBus_\".$_IPS['TARGET'], $logMsg);\r\nreturn [\"40366_OutWRte\" => $OutWRte, \"40359_StorCtl_Mod\" => $StorCtl_Mod];"
        },
        {
            "Active": true,
            "Ident": "VA_DISCHARGE_MIN",
            "Name": "DISCHARGE_MIN",
            "Profile": "Fronius.DISCHARGE_MIN",
            "ReadAction": "$WChaMax = $VALUES[\"40356_WChaMax\"];\r\n$StorCtl_Mod = $VALUES[\"40359_StorCtl_Mod\"];\r\n$InWRte = $VALUES[\"40367_InWRte\"];\r\nif(($StorCtl_Mod == 1) OR ($StorCtl_Mod == 3)) {\r\n    if($InWRte >= 0) { \r\n        return -1; \r\n    } else {\r\n        return abs(round($WChaMax / 100 * $InWRte, 1));\r\n    }\r\n} else {\r\n    return -1;\r\n}",
            "Translation": [],
            "VariableType": 2,
            "WriteAction": "$WChaMax = $VALUES[\"40356_WChaMax\"];\r\n$StorCtl_Mod = $VALUES[\"40359_StorCtl_Mod\"];\r\nif( $VALUE < 0) {\r\n  $InWRte = 100; \r\n  if($StorCtl_Mod != 3) { $StorCtl_Mod = 1; }\r\n} else {\r\n  $InWRte = round(100/$WChaMax * $VALUE, 2) * -1;\r\n  if($InWRte < -100) { $InWRte = -100; } \r\n  if($StorCtl_Mod != 3) {\r\n    $StorCtl_Mod = 1;  \r\n  } else {\r\n    $OutWRte = $VALUES[\"40366_OutWRte\"];\r\n    if( (-1 * $InWRte) > $OutWRte) {\r\n      $logMsg = sprintf(\"DISCHARGE_MIN - Invalid power window > Set StorCtl_Mod = 1 [40359_StorCtl_Mod: %s | 40366_OutWRte: %s | 40367_InWRte: %s | VALUE: %s] {%s | %s}\", $StorCtl_Mod, $OutWRte, $InWRte, $VALUE, $_IPS['SENDER'], IPS_GetName($_IPS['TARGET']));\r\n      $varIdLogInfo = @IPS_GetVariableIDByName(\"LogInfo\", $_IPS['TARGET']); if($varIdLogInfo !== false) { SetValue($varIdLogInfo, $logMsg); }\r\n      IPS_LogMessage(\"FroniusModBus_\".$_IPS['TARGET'].\"-WARN\", $logMsg);      \r\n      return [\"40359_StorCtl_Mod\" => 1];\r\n    }\r\n  }\r\n}\r\n$logMsg = sprintf(\"DISCHARGE_MIN | 40359_StorCtl_Mod: %s | 40367_InWRte: %s | VALUE: %s {%s | %s}\",  $StorCtl_Mod, $InWRte, $VALUE, $_IPS['SENDER'], IPS_GetName($_IPS['TARGET']));\r\n$varIdLogInfo = @IPS_GetVariableIDByName(\"LogInfo\", $_IPS['TARGET']); if($varIdLogInfo !== false) { SetValue($varIdLogInfo, $logMsg); }\r\nIPS_LogMessage(\"FroniusModBus_\".$_IPS['TARGET'], $logMsg);\r\nreturn [\"40367_InWRte\" => $InWRte, \"40359_StorCtl_Mod\" => $StorCtl_Mod];"
        },
        {
            "Active": true,
            "Ident": "VA_ControlActive",
            "Name": "ControlActive",
            "Profile": "~Switch",
            "ReadAction": "$StorCtl_Mod = $VALUES[\"40359_StorCtl_Mod\"];\r\n$OutWRte = $VALUES[\"40366_OutWRte\"];\r\n$InWRte = $VALUES[\"40367_InWRte\"];\r\nif( ($StorCtl_Mod > 0) AND (($OutWRte != 100) OR ($InWRte != 100))) {\r\n    return true;\r\n} else {\r\n    return false;\r\n}",
            "Translation": [],
            "VariableType": 0,
            "WriteAction": "if($VALUE) {\r\n    return null;\r\n} else {\r\n  return [\"40359_StorCtl_Mod\" => 0, \"40366_OutWRte\" => 100, \"40367_InWRte\" => 100];  \r\n}"
        }
    ]
}